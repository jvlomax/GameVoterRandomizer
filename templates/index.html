<!DOCTYPE html>
<html>
<head>
    <script type="application/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script type="application/javascript" src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>

    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/bootstrap.css') }}"/>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/my.css') }}"/>
</head>

<body>
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle Navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">Mighty awesome game chooser</a>
            </div>

        <div class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li class="active"><a href="#">Home</a></li>
                <li><a href="#mygames"> My games</a></li>
                <li><a href="about.html">About</a></li>


            </ul>
          </div>
        </div>


    </div>
    <div class="container">
        <div style="padding: 40px 50px; text-align: center">
            <form action=""><ul class="list-group" id="gameList">
                {%for game in games %}
                         <li class="list-group-item"><input type="checkbox" id="{{ game.id }}" name="{{ game.title }}" value="{{ game.title }}" {% if game.title in likes %} checked="true" {%  endif %}>{{ game.title }}  | Number of likes = <span id="{{ game.id }}_likes">{{ game.num_likes }}</span></li>
               {% endfor %}
            </ul>
            </form>
        <div class="btn-group">
            <button class="btn btn-default btn-lg" id="addBtn"><span class="glyphicon glyphicon-plus"></span>Add a game</button>
            <Button value="Save" id="saveBtn" class="btn btn-default btn-lg"><span class="glyphicon glyphicon-save"></span>Save </Button>
        </div>
    </div>

</body>

<script>



$(document).ready(function(){

    $(":checkbox").change(function()    {
        var span_name = $(this).attr("id") + "_likes";
        var likes = parseInt($("#" + span_name).text());

        if($(this).is(":checked")){
            likes ++;
            $("#" + span_name).text(likes);
            console.log(likes);
        }else{
            likes --;
            $("#" + span_name).text(likes);
        }
    })
    $("#saveBtn").click(function(){
        var checkBoxes = $( ":checkbox");
        console.log(checkBoxes);
        len = checkBoxes.length;
        var my_games = [];
        for (var i = 0; i < len; i++){
            if (checkBoxes[i].checked){
                my_games.push(checkBoxes[i].name);
            }

        }
        console.log(my_games);

        $.post("save", JSON.stringify(my_games), function(response){

        }, "json");
    });

    $("#addBtn").click(function(){
        var list = $("#gameList");
        var inputfield = '<li id="newfield" class="new-item list-group-item">' +
                '<div class="input-group">' +
                '<input class="form-control" type="text" placeholder="Insert name...">' +
                '<span class="input-group-btn">' +
                '<button class="btn btn-default" type="button">Save' +
                '</button><span></div></li>';


        $("#gameList").append(inputfield)
        $("#addBtn").attr("disabled", "disabled");
    });

});
</script>
</html>
